MindBrige_image_GIT_ViT_without_softclip starting with epoch 0 / 400
>>> Epoch0 | Iter0 | voxel: torch.Size([1000, 8192])
  0%|                                                                                                                                                 | 0/400 [00:00<?, ?it/s]
>>> Epoch0 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch0 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 37.4413629259382
train/lr: 0.0005090736650290693
train/num_steps: 35
train/cosine_sim_image: 0.19753438700655743
train/loss_mse_image: 1.0738984227180481
train/loss_mae_image: 0.8003055504390172
train/loss_nce_image: 6.8789626938956125
train/loss_rec: 0.5947336060660225
train/loss_cyc: 0.48664291245596747
Evaluating...
>>> Epoch0 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 26.155981063842773
val/val_num_steps: 6
val/val_cosine_sim_image: 0.3431595116853714
val/val_loss_mse_image: 0.7003370424111685
val/val_loss_mae_image: 0.6425308187802633
val/val_loss_nce_image: 5.328512191772461
val/val_loss_rec: 0.36743295689423877

  0%|▎                                                                                                     | 1/400 [01:10<7:49:50, 70.65s/it, epoch=0, lr=0.000509, loss=37.4]
>>> Epoch1 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch1 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 28.353076553344728
train/lr: 0.001
train/num_steps: 70
train/cosine_sim_image: 0.3229706883430481
train/loss_mse_image: 0.7205347452844892
train/loss_mae_image: 0.6532497440065657
train/loss_nce_image: 6.893494115556989
train/loss_rec: 0.36347436564309255
train/loss_cyc: 0.1529153436422348
Evaluating...
>>> Epoch1 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval2 | voxel: torch.Size([200, 8192])

  0%|▌                                                                                                        | 2/400 [02:21<7:47:31, 70.48s/it, epoch=1, lr=0.001, loss=28.4]
>>> Epoch1 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 25.59208043416341
val/val_num_steps: 12
val/val_cosine_sim_image: 0.3713202476501465
val/val_loss_mse_image: 0.6785874466101328
val/val_loss_mae_image: 0.630341629187266
val/val_loss_nce_image: 5.339481512705485
val/val_loss_rec: 0.35744959612687427
val/val_loss_cyc: 0.019983505209287006
>>> Epoch2 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch2 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 27.62374632699149
train/lr: 0.000999984454600184
train/num_steps: 105
train/cosine_sim_image: 0.3501085340976715
train/loss_mse_image: 0.6948746732303075
train/loss_mae_image: 0.6393415825707572
train/loss_nce_image: 6.897256905691965
train/loss_rec: 0.35734309809548515
train/loss_cyc: 0.0782373073909964
Evaluating...
>>> Epoch2 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval1 | voxel: torch.Size([200, 8192])

  1%|▊                                                                                                        | 3/400 [03:31<7:46:36, 70.52s/it, epoch=2, lr=0.001, loss=27.6]
>>> Epoch2 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 25.418370882670086
val/val_num_steps: 18
val/val_cosine_sim_image: 0.3798849234978358
val/val_loss_mse_image: 0.6729350884755453
val/val_loss_mae_image: 0.6267868181069692
val/val_loss_nce_image: 5.337308963139852
val/val_loss_rec: 0.34812221427758533
val/val_loss_cyc: 0.006369608221575618
>>> Epoch3 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch3 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 27.15569474356515
train/lr: 0.0009999378193693111
train/num_steps: 140
train/cosine_sim_image: 0.36917589817728313
train/loss_mse_image: 0.6803904618535723
train/loss_mae_image: 0.6312943748065404
train/loss_nce_image: 6.866944394792829
train/loss_rec: 0.35255098768642973
train/loss_cyc: 0.015446662450475351
Evaluating...
>>> Epoch3 | Eval0 | voxel: torch.Size([200, 8192])

  1%|█                                                                                                        | 4/400 [04:41<7:44:53, 70.44s/it, epoch=3, lr=0.001, loss=27.2]
>>> Epoch3 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 25.04345989227295
val/val_num_steps: 24
val/val_cosine_sim_image: 0.3915354510148366
val/val_loss_mse_image: 0.6657216449578603
val/val_loss_mae_image: 0.6235849459966024
val/val_loss_nce_image: 5.149112701416016
val/val_loss_rec: 0.338696226477623
val/val_loss_cyc: 0.005368414179732402
>>> Epoch4 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch4 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 26.775718416486466
train/lr: 0.0009998600972130455
train/num_steps: 175
train/cosine_sim_image: 0.38210249458040507
train/loss_mse_image: 0.6725025125912257
train/loss_mae_image: 0.6275990537234715
train/loss_nce_image: 6.691209833962577
train/loss_rec: 0.3394281302179609
train/loss_cyc: 0.019039707391389778
Evaluating...

  1%|█▎                                                                                                       | 5/400 [05:52<7:43:31, 70.41s/it, epoch=4, lr=0.001, loss=26.8]
>>> Epoch4 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 24.823139190673828
val/val_num_steps: 30
val/val_cosine_sim_image: 0.39886190990606946
val/val_loss_mse_image: 0.6609353025754293
val/val_loss_mae_image: 0.6211328506469727
val/val_loss_nce_image: 5.068608999252319
val/val_loss_rec: 0.32259785135587055
val/val_loss_cyc: 0.0018978582811541855
>>> Epoch5 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch5 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 26.43869732448033
train/lr: 0.0009997512929739607
train/num_steps: 210
train/cosine_sim_image: 0.3938896553856986
train/loss_mse_image: 0.6645138127463205
train/loss_mae_image: 0.6235519187791007
train/loss_nce_image: 6.585200732094901
train/loss_rec: 0.31628305656569344
train/loss_cyc: 0.011418158800474235
Evaluating...
>>> Epoch5 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch5 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch5 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch5 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch5 | Eval4 | voxel: torch.Size([200, 8192])

  2%|█▌                                                                                                       | 6/400 [07:02<7:42:28, 70.43s/it, epoch=5, lr=0.001, loss=26.4]
val/val_loss: 24.636050542195637
val/val_num_steps: 36
val/val_cosine_sim_image: 0.40285108983516693
val/val_loss_mse_image: 0.6587032477060953
val/val_loss_mae_image: 0.6205387910207113
val/val_loss_nce_image: 4.949805736541748
val/val_loss_rec: 0.30263115962346393
val/val_loss_cyc: 0.004160737502388656
>>> Epoch6 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch6 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 26.067993382045202
train/lr: 0.0009996114134312366
train/num_steps: 245
train/cosine_sim_image: 0.40422536049570357
train/loss_mse_image: 0.6579952035631452
train/loss_mae_image: 0.6207692759377615
train/loss_nce_image: 6.379261929648263
train/loss_rec: 0.3056389442511967
train/loss_cyc: 0.01549640478832381
Evaluating...
>>> Epoch6 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch6 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch6 | Eval2 | voxel: torch.Size([200, 8192])

  2%|█▊                                                                                                       | 7/400 [08:13<7:41:43, 70.49s/it, epoch=6, lr=0.001, loss=26.1]
>>> Epoch6 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch6 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 24.073676745096844
val/val_num_steps: 42
val/val_cosine_sim_image: 0.41905886431535083
val/val_loss_mse_image: 0.6475087900956472
val/val_loss_mae_image: 0.6153387327988943
val/val_loss_nce_image: 4.676755428314209
val/val_loss_rec: 0.2900922993818919
val/val_loss_cyc: 0.0032655566465109587
>>> Epoch7 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch7 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 25.59076647077288
train/lr: 0.0009994404673002372
train/num_steps: 280
train/cosine_sim_image: 0.41858923946108134
train/loss_mse_image: 0.648308527469635
train/loss_mae_image: 0.6162976128714425
train/loss_nce_image: 6.1484296526227675
train/loss_rec: 0.298222302539008
train/loss_cyc: 0.014967924915254116
Evaluating...
>>> Epoch7 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch7 | Eval1 | voxel: torch.Size([200, 8192])

  2%|██                                                                                                    | 8/400 [09:23<7:40:53, 70.54s/it, epoch=7, lr=0.000999, loss=25.6]
>>> Epoch7 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch7 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch7 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 23.631826718648274
val/val_num_steps: 48
val/val_cosine_sim_image: 0.4332201232512792
val/val_loss_mse_image: 0.6379421353340149
val/val_loss_mae_image: 0.6105114618937174
val/val_loss_nce_image: 4.480359395345052
val/val_loss_rec: 0.2837715595960617
val/val_loss_cyc: 0.0037388044875115156
>>> Epoch8 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch8 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 25.130100195748465
train/lr: 0.000999238465231969
train/num_steps: 315
train/cosine_sim_image: 0.432040650503976
train/loss_mse_image: 0.6390900441578456
train/loss_mae_image: 0.612068133694785
train/loss_nce_image: 5.924017333984375
train/loss_rec: 0.28614718999181477
train/loss_cyc: 0.01745305827685765
Evaluating...

  2%|██▎                                                                                                   | 9/400 [10:34<7:39:45, 70.55s/it, epoch=8, lr=0.000999, loss=25.1]
>>> Epoch8 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch8 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch8 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch8 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch8 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 23.25227165222168
val/val_num_steps: 54
val/val_cosine_sim_image: 0.44204651316006977
val/val_loss_mse_image: 0.6316642959912618
val/val_loss_mae_image: 0.6079613169034322
val/val_loss_nce_image: 4.262331247329712
val/val_loss_rec: 0.27312170962492627
val/val_loss_cyc: 0.003920013356643419
>>> Epoch9 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch9 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 24.756818553379603
train/lr: 0.0009990054198124152
train/num_steps: 350
train/cosine_sim_image: 0.4432359746524266
train/loss_mse_image: 0.6310287322316851
train/loss_mae_image: 0.6082128388541085
train/loss_nce_image: 5.759057399204799
train/loss_rec: 0.27809197902679444
train/loss_cyc: 0.0169661889650992
Evaluating...
>>> Epoch9 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch9 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch9 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch9 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch9 | Eval4 | voxel: torch.Size([200, 8192])

  2%|██▌                                                                                                  | 10/400 [11:45<7:38:28, 70.54s/it, epoch=9, lr=0.000999, loss=24.8]
val/val_loss: 23.078508059183758
val/val_num_steps: 60
val/val_cosine_sim_image: 0.4484445701042811
val/val_loss_mse_image: 0.6267882188161215
val/val_loss_mae_image: 0.6055287023385366
val/val_loss_nce_image: 4.212705532709758
val/val_loss_rec: 0.2705773264169693
val/val_loss_cyc: 0.004174043812478582
>>> Epoch10 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter18 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter19 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter20 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter21 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter22 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter23 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter24 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter25 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter26 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter27 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter28 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter29 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter30 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter31 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter32 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter33 | voxel: torch.Size([1000, 8192])
>>> Epoch10 | Iter34 | voxel: torch.Size([236, 8192])
train/loss: 24.425789315359932
train/lr: 0.000998741345561753
train/num_steps: 385
train/cosine_sim_image: 0.45299822432654246
train/loss_mse_image: 0.6238720178604126
train/loss_mae_image: 0.6047855019569397
train/loss_nce_image: 5.611457347869873
train/loss_rec: 0.2725851195199149
train/loss_cyc: 0.016451039697442736
Evaluating...
>>> Epoch10 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch10 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch10 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch10 | Eval3 | voxel: torch.Size([200, 8192])

  3%|██▊                                                                                                 | 11/400 [12:55<7:36:44, 70.45s/it, epoch=10, lr=0.000999, loss=24.4]
>>> Epoch10 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 22.934497197469074
val/val_num_steps: 66
val/val_cosine_sim_image: 0.45105843742688495
val/val_loss_mse_image: 0.6253853241602579
val/val_loss_mae_image: 0.6052052080631256
val/val_loss_nce_image: 4.104767243067424
val/val_loss_rec: 0.26480556031068164
val/val_loss_cyc: 0.005166051327250898
>>> Epoch11 | Iter0 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter1 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter2 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter3 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter4 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter5 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter6 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter7 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter8 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter9 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter10 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter11 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter12 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter13 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter14 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter15 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter16 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter17 | voxel: torch.Size([1000, 8192])
>>> Epoch11 | Iter18 | voxel: torch.Size([1000, 8192])
  3%|██▊                                                                                                 | 11/400 [13:35<8:00:55, 74.18s/it, epoch=10, lr=0.000999, loss=24.4]
Traceback (most recent call last):
  File "/media/SSD_1_2T/xt/MindBridge/src/main.py", line 300, in <module>
    main()
  File "/media/SSD_1_2T/xt/MindBridge/src/main.py", line 294, in main
    trainer.train(local_rank)
  File "/media/SSD_1_2T/xt/MindBridge/src/trainer_fmri_img_GIT.py", line 164, in train
    self.train_epoch(epoch)
  File "/media/SSD_1_2T/xt/MindBridge/src/trainer_fmri_img_GIT.py", line 626, in train_epoch
    self.train_step(voxel, image, subj_id, epoch)
  File "/media/SSD_1_2T/xt/MindBridge/src/trainer_fmri_img_GIT.py", line 198, in train_step
    fmri_image, fmri_rec, loss_cyc = self.voxel2clip(self.input(voxel, subj_id))
  File "/home/fmri/miniconda3/envs/xt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/fmri/miniconda3/envs/xt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/media/SSD_1_2T/xt/MindBridge/src/models.py", line 442, in forward
    subj_list = x[1].tolist()  # (s,)
KeyboardInterrupt