MindBrige_image_vitb32_multilayer_23456 starting with epoch 0 / 200
>>> Epoch0 | Iter0 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter1 | voxel: torch.Size([800, 8192])
  0%|                                                                                                                                                 | 0/200 [00:00<?, ?it/s]
>>> Epoch0 | Iter2 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter3 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter4 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter5 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter6 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter7 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter8 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter9 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter10 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter11 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter12 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter13 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter14 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter15 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter16 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter17 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter18 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter19 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter20 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter21 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter22 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter23 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter24 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter25 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter26 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter27 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter28 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter29 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter30 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter31 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter32 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter33 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter34 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter35 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter36 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter37 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter38 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter39 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter40 | voxel: torch.Size([800, 8192])
>>> Epoch0 | Iter41 | voxel: torch.Size([800, 8192])

  0%|▌                                                                                                       | 1/200 [00:17<57:33, 17.35s/it, epoch=0, lr=0.000179, loss=27.1]
train/loss: 27.146472487338755
train/lr: 0.0001788955439668662
train/num_steps: 43
train/cosine_sim_image_fc: 0.34330873868731393
train/cosine_sim_image_2: 0.2503829949879261
train/cosine_sim_image_3: 0.2434677428100258
train/cosine_sim_image_4: 0.2222079040325615
train/cosine_sim_image_5: 0.21618901065897284
train/cosine_sim_image_6: 0.21378075013608608
train/loss_mse_image_fc: 5.1304004236319387e-05
train/loss_mse_image_2: 3.9042552765919066e-05
train/loss_mse_image_3: 3.940272252420559e-05
train/loss_mse_image_4: 4.051000571560634e-05
train/loss_mse_image_5: 4.0823490434017594e-05
train/loss_mse_image_6: 4.094892032891187e-05
train/loss_mae_image_fc: 0.0053035773033666056
train/loss_mae_image_2: 0.004694941930126312
train/loss_mae_image_3: 0.004731359350126843
train/loss_mae_image_4: 0.0048370994952355705
train/loss_mae_image_5: 0.004901997160253136
train/loss_mae_image_6: 0.004914263674859391
train/loss_clip_image_fc: 0.0
train/loss_clip_image_2: 0.0
train/loss_clip_image_3: 0.0
train/loss_clip_image_4: 0.0
train/loss_clip_image_5: 0.0
train/loss_clip_image_6: 0.0
train/loss_rec: 1.0747922076735386
train/loss_cyc: 0.7913949066816375
Evaluating...
>>> Epoch0 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch0 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 19.447564760843914
val/val_num_steps: 6
val/val_cosine_sim_image_fc: 0.5836357772350311
val/val_cosine_sim_image_2: 0.4490264604489009
val/val_cosine_sim_image_3: 0.4347478151321411
val/val_cosine_sim_image_4: 0.3942015965779622
val/val_cosine_sim_image_5: 0.386540487408638
val/val_cosine_sim_image_6: 0.38618506987889606
val/val_loss_mse_image_fc: 3.2528456358704716e-05
val/val_loss_mse_image_2: 2.8696539023561247e-05
val/val_loss_mse_image_3: 2.9440219198780444e-05
val/val_loss_mse_image_4: 3.155200101900846e-05
val/val_loss_mse_image_5: 3.195101635355968e-05
val/val_loss_mse_image_6: 3.196952699605996e-05
val/val_loss_mae_image_fc: 0.004222461022436619
val/val_loss_mae_image_2: 0.0038401049096137285
val/val_loss_mae_image_3: 0.003927409493674834
val/val_loss_mae_image_4: 0.004120797694971164
val/val_loss_mae_image_5: 0.0042009511962533
val/val_loss_mae_image_6: 0.004236145488296946
val/val_loss_clip_image_fc: 0.0
val/val_loss_clip_image_2: 0.0
val/val_loss_clip_image_3: 0.0
val/val_loss_clip_image_4: 0.0
val/val_loss_clip_image_5: 0.0
val/val_loss_clip_image_6: 0.0
val/val_loss_rec: 0.7315097153186798
val/val_loss_cyc: 0.039729900658130646
>>> Epoch1 | Iter0 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter1 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter2 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter3 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter4 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter5 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter6 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter7 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter8 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter9 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter10 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter11 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter12 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter13 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter14 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter15 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter16 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter17 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter18 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter19 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter20 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter21 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter22 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter23 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter24 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter25 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter26 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter27 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter28 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter29 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter30 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter31 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter32 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter33 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter34 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter35 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter36 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter37 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter38 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter39 | voxel: torch.Size([800, 8192])

  1%|█                                                                                                        | 2/200 [00:34<56:10, 17.02s/it, epoch=1, lr=0.00035, loss=17.8]
>>> Epoch1 | Iter41 | voxel: torch.Size([800, 8192])
>>> Epoch1 | Iter42 | voxel: torch.Size([636, 8192])
train/loss: 17.84623030729072
train/lr: 0.00035
train/num_steps: 86
train/cosine_sim_image_fc: 0.6658383982126103
train/cosine_sim_image_2: 0.4922384058320245
train/cosine_sim_image_3: 0.47603351640146835
train/cosine_sim_image_4: 0.4376971638479898
train/cosine_sim_image_5: 0.4289651831915212
train/cosine_sim_image_6: 0.43600704988767935
train/loss_mse_image_fc: 2.6106376280103874e-05
train/loss_mse_image_2: 2.6445917260283498e-05
train/loss_mse_image_3: 2.728992204051898e-05
train/loss_mse_image_4: 2.9286606742209908e-05
train/loss_mse_image_5: 2.9741397833446215e-05
train/loss_mse_image_6: 2.937463360404065e-05
train/loss_mae_image_fc: 0.003853334130199496
train/loss_mae_image_2: 0.003631608555266677
train/loss_mae_image_3: 0.003706933286170973
train/loss_mae_image_4: 0.0038701428620274677
train/loss_mae_image_5: 0.003941519516195322
train/loss_mae_image_6: 0.003938209471227818
train/loss_clip_image_fc: 0.0
train/loss_clip_image_2: 0.0
train/loss_clip_image_3: 0.0
train/loss_clip_image_4: 0.0
train/loss_clip_image_5: 0.0
train/loss_clip_image_6: 0.0
train/loss_rec: 0.7668823849323184
train/loss_cyc: 0.19724076466504917
Evaluating...
>>> Epoch1 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch1 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 16.601707458496094
val/val_num_steps: 12
val/val_cosine_sim_image_fc: 0.7057830393314362
val/val_cosine_sim_image_2: 0.5179169575373331
val/val_cosine_sim_image_3: 0.5032161772251129
val/val_cosine_sim_image_4: 0.4654158999522527
val/val_cosine_sim_image_5: 0.4532390038172404
val/val_cosine_sim_image_6: 0.46429216861724854
val/val_loss_mse_image_fc: 2.2985701131498597e-05
val/val_loss_mse_image_2: 2.510849329458627e-05
val/val_loss_mse_image_3: 2.5874158685231425e-05
val/val_loss_mse_image_4: 2.7842922463605646e-05
val/val_loss_mse_image_5: 2.847713525018965e-05
val/val_loss_mse_image_6: 2.790145147931374e-05
val/val_loss_mae_image_fc: 0.003616820555180311
val/val_loss_mae_image_2: 0.003503969443651537
val/val_loss_mae_image_3: 0.0035859454267968736
val/val_loss_mae_image_4: 0.0037387667689472437
val/val_loss_mae_image_5: 0.003818319373143216
val/val_loss_mae_image_6: 0.003798043355345726
val/val_loss_clip_image_fc: 0.0
val/val_loss_clip_image_2: 0.0
val/val_loss_clip_image_3: 0.0
val/val_loss_clip_image_4: 0.0
val/val_loss_clip_image_5: 0.0
val/val_loss_clip_image_6: 0.0
val/val_loss_rec: 0.7076616982618967
val/val_loss_cyc: 0.020446425614257652
>>> Epoch2 | Iter0 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter1 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter2 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter3 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter4 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter5 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter6 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter7 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter8 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter9 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter10 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter11 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter12 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter13 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter14 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter15 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter16 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter17 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter18 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter19 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter20 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter21 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter22 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter23 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter24 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter25 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter26 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter27 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter28 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter29 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter30 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter31 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter32 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter33 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter34 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter35 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter36 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter37 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter38 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter39 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter40 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter41 | voxel: torch.Size([800, 8192])
>>> Epoch2 | Iter42 | voxel: torch.Size([636, 8192])
train/loss: 16.756281919257585
train/lr: 0.0003499780163982423
train/num_steps: 129
train/cosine_sim_image_fc: 0.6972345293954362
train/cosine_sim_image_2: 0.5178619969722836
train/cosine_sim_image_3: 0.5063313890335172
train/cosine_sim_image_4: 0.4673832952976227
train/cosine_sim_image_5: 0.45331864370856173
train/cosine_sim_image_6: 0.46332015755564665
train/loss_mse_image_fc: 2.365355435041386e-05
train/loss_mse_image_2: 2.5111355107794733e-05
train/loss_mse_image_3: 2.5711908165249042e-05
train/loss_mse_image_4: 2.77404542430304e-05
train/loss_mse_image_5: 2.8472987841544022e-05
train/loss_mse_image_6: 2.795207618937427e-05
train/loss_mae_image_fc: 0.003685733947772966
train/loss_mae_image_2: 0.0035456728926578232
train/loss_mae_image_3: 0.0036218698721292406
train/loss_mae_image_4: 0.0037745848937003417
train/loss_mae_image_5: 0.003849323541142566
train/loss_mae_image_6: 0.0038343756243066733
train/loss_clip_image_fc: 0.0
train/loss_clip_image_2: 0.0
train/loss_clip_image_3: 0.0
train/loss_clip_image_4: 0.0
train/loss_clip_image_5: 0.0
train/loss_clip_image_6: 0.0
train/loss_rec: 0.7133144167966621
train/loss_cyc: 0.12325072184551594

  2%|█▌                                                                                                       | 3/200 [00:50<55:36, 16.93s/it, epoch=2, lr=0.00035, loss=16.8]
>>> Epoch2 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch2 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 16.233163197835285
val/val_num_steps: 18
val/val_cosine_sim_image_fc: 0.7066821952660879
val/val_cosine_sim_image_2: 0.5295907557010651
val/val_cosine_sim_image_3: 0.521101156870524
val/val_cosine_sim_image_4: 0.4801664501428604
val/val_cosine_sim_image_5: 0.4628317803144455
val/val_cosine_sim_image_6: 0.47366883357365924
val/val_loss_mse_image_fc: 2.2915452973393258e-05
val/val_loss_mse_image_2: 2.4500482444030542e-05
val/val_loss_mse_image_3: 2.4942648451542482e-05
val/val_loss_mse_image_4: 2.707466531622534e-05
val/val_loss_mse_image_5: 2.797751191489321e-05
val/val_loss_mse_image_6: 2.7413082231457036e-05
val/val_loss_mae_image_fc: 0.003601595565366248
val/val_loss_mae_image_2: 0.0034811960455651083
val/val_loss_mae_image_3: 0.0035488204254458347
val/val_loss_mae_image_4: 0.003705161662461857
val/val_loss_mae_image_5: 0.0037934715316320458
val/val_loss_mae_image_6: 0.003774628625251353
val/val_loss_clip_image_fc: 0.0
val/val_loss_clip_image_2: 0.0
val/val_loss_clip_image_3: 0.0
val/val_loss_clip_image_4: 0.0
val/val_loss_clip_image_5: 0.0
val/val_loss_clip_image_6: 0.0
val/val_loss_rec: 0.6842403809229533
val/val_loss_cyc: 0.01221997244283557
>>> Epoch3 | Iter0 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter1 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter2 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter3 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter4 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter5 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter6 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter7 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter8 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter9 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter10 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter11 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter12 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter13 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter14 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter15 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter16 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter17 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter18 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter19 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter20 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter21 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter22 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter23 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter24 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter25 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter26 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter27 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter28 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter29 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter30 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter31 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter32 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter33 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter34 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter35 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter36 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter37 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter38 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter39 | voxel: torch.Size([800, 8192])
>>> Epoch3 | Iter40 | voxel: torch.Size([800, 8192])

  2%|██                                                                                                       | 4/200 [01:07<55:14, 16.91s/it, epoch=3, lr=0.00035, loss=16.4]
>>> Epoch3 | Iter42 | voxel: torch.Size([636, 8192])
train/loss: 16.43967584122059
train/lr: 0.00034991207112722327
train/num_steps: 172
train/cosine_sim_image_fc: 0.7005838668623636
train/cosine_sim_image_2: 0.5251845162968303
train/cosine_sim_image_3: 0.5157338644182959
train/cosine_sim_image_4: 0.47536992749502494
train/cosine_sim_image_5: 0.4589956132478492
train/cosine_sim_image_6: 0.46896520464919333
train/loss_mse_image_fc: 2.3391886887026865e-05
train/loss_mse_image_2: 2.4729973691052672e-05
train/loss_mse_image_3: 2.5222195057891483e-05
train/loss_mse_image_4: 2.7324483727530015e-05
train/loss_mse_image_5: 2.8177313017591205e-05
train/loss_mse_image_6: 2.7658062948788474e-05
train/loss_mae_image_fc: 0.003653239816167327
train/loss_mae_image_2: 0.0035245832878836366
train/loss_mae_image_3: 0.003595262874177722
train/loss_mae_image_4: 0.003745048653421014
train/loss_mae_image_5: 0.003823813792794596
train/loss_mae_image_6: 0.0038074592215030694
train/loss_clip_image_fc: 0.0
train/loss_clip_image_2: 0.0
train/loss_clip_image_3: 0.0
train/loss_clip_image_4: 0.0
train/loss_clip_image_5: 0.0
train/loss_clip_image_6: 0.0
train/loss_rec: 0.6766218418298766
train/loss_cyc: 0.05763375343278397
Evaluating...
>>> Epoch3 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval2 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval3 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch3 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 16.112939993540447
val/val_num_steps: 24
val/val_cosine_sim_image_fc: 0.7069670855998993
val/val_cosine_sim_image_2: 0.5329545636971792
val/val_cosine_sim_image_3: 0.5245048999786377
val/val_cosine_sim_image_4: 0.4829012503226598
val/val_cosine_sim_image_5: 0.4646746913592021
val/val_cosine_sim_image_6: 0.4753037045399348
val/val_loss_mse_image_fc: 2.2893197941205774e-05
val/val_loss_mse_image_2: 2.432528405430882e-05
val/val_loss_mse_image_3: 2.4765370956932504e-05
val/val_loss_mse_image_4: 2.693222783515618e-05
val/val_loss_mse_image_5: 2.78815277852118e-05
val/val_loss_mse_image_6: 2.732793382165255e-05
val/val_loss_mae_image_fc: 0.003597040039797624
val/val_loss_mae_image_2: 0.0034640099620446563
val/val_loss_mae_image_3: 0.0035265422969435654
val/val_loss_mae_image_4: 0.003682513798897465
val/val_loss_mae_image_5: 0.0037784830201417208
val/val_loss_mae_image_6: 0.003759895257341365
val/val_loss_clip_image_fc: 0.0
val/val_loss_clip_image_2: 0.0
val/val_loss_clip_image_3: 0.0
val/val_loss_clip_image_4: 0.0
val/val_loss_clip_image_5: 0.0
val/val_loss_clip_image_6: 0.0
val/val_loss_rec: 0.6387388110160828
val/val_loss_cyc: 0.007465025254835685
>>> Epoch4 | Iter0 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter1 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter2 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter3 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter4 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter5 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter6 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter7 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter8 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter9 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter10 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter11 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter12 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter13 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter14 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter15 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter16 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter17 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter18 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter19 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter20 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter21 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter22 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter23 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter24 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter25 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter26 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter27 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter28 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter29 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter30 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter31 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter32 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter33 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter34 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter35 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter36 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter37 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter38 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter39 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter40 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter41 | voxel: torch.Size([800, 8192])
>>> Epoch4 | Iter42 | voxel: torch.Size([636, 8192])
train/loss: 16.282122989033542
train/lr: 0.00034980218078831235
train/num_steps: 215
train/cosine_sim_image_fc: 0.7024943967198216
train/cosine_sim_image_2: 0.5282550980878431
train/cosine_sim_image_3: 0.5194697865220004
train/cosine_sim_image_4: 0.4788973622543867
train/cosine_sim_image_5: 0.4617727821649507
train/cosine_sim_image_6: 0.4717348522918169
train/loss_mse_image_fc: 2.3242625777425547e-05
train/loss_mse_image_2: 2.457004856571371e-05
train/loss_mse_image_3: 2.5027616703842205e-05
train/loss_mse_image_4: 2.7140763217345054e-05
train/loss_mse_image_5: 2.8032668587700247e-05
train/loss_mse_image_6: 2.751381095528581e-05
train/loss_mae_image_fc: 0.0036356410358187766
train/loss_mae_image_2: 0.003505134630168593
train/loss_mae_image_3: 0.0035693033403435418
train/loss_mae_image_4: 0.003719290068676305
train/loss_mae_image_5: 0.0038032885749152926
train/loss_mae_image_6: 0.003786568427025232
train/loss_clip_image_fc: 0.0
train/loss_clip_image_2: 0.0
train/loss_clip_image_3: 0.0
train/loss_clip_image_4: 0.0
train/loss_clip_image_5: 0.0
train/loss_clip_image_6: 0.0
train/loss_rec: 0.6460120165070822
train/loss_cyc: 0.0286177292379529
Evaluating...
>>> Epoch4 | Eval0 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval1 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval2 | voxel: torch.Size([200, 8192])

  2%|██▋                                                                                                      | 5/200 [01:24<54:51, 16.88s/it, epoch=4, lr=0.00035, loss=16.3]
>>> Epoch4 | Eval4 | voxel: torch.Size([200, 8192])
>>> Epoch4 | Eval5 | voxel: torch.Size([200, 8192])
val/val_loss: 16.009406566619873
val/val_num_steps: 30
val/val_cosine_sim_image_fc: 0.7081725398699442
val/val_cosine_sim_image_2: 0.5346516370773315
val/val_cosine_sim_image_3: 0.5268032451470693
val/val_cosine_sim_image_4: 0.48585860927899677
val/val_cosine_sim_image_5: 0.46759259700775146
val/val_cosine_sim_image_6: 0.47837639848391217
val/val_loss_mse_image_fc: 2.279902067433189e-05
val/val_loss_mse_image_2: 2.423689481171702e-05
val/val_loss_mse_image_3: 2.464566629593416e-05
val/val_loss_mse_image_4: 2.677819793461822e-05
val/val_loss_mse_image_5: 2.7729552433205146e-05
val/val_loss_mse_image_6: 2.716789640544448e-05
val/val_loss_mae_image_fc: 0.0035873123755057654
val/val_loss_mae_image_2: 0.0034562196427335343
val/val_loss_mae_image_3: 0.0035167529325311384
val/val_loss_mae_image_4: 0.0036694155229876437
val/val_loss_mae_image_5: 0.0037633874841655293
val/val_loss_mae_image_6: 0.003744242829270661
val/val_loss_clip_image_fc: 0.0
val/val_loss_clip_image_2: 0.0
val/val_loss_clip_image_3: 0.0
val/val_loss_clip_image_4: 0.0
val/val_loss_clip_image_5: 0.0
val/val_loss_clip_image_6: 0.0
val/val_loss_rec: 0.6126249730587006
val/val_loss_cyc: 0.007035932581250866
>>> Epoch5 | Iter0 | voxel: torch.Size([800, 8192])
  2%|██▋                                                                                                      | 5/200 [01:27<57:01, 17.55s/it, epoch=4, lr=0.00035, loss=16.3]
Traceback (most recent call last):
  File "/media/SSD_1_2T/xt/MindBridge/src/main.py", line 247, in <module>
    main()
  File "/media/SSD_1_2T/xt/MindBridge/src/main.py", line 241, in main
    trainer.train(local_rank)
  File "/media/SSD_1_2T/xt/MindBridge/src/trainer_fmri_img.py", line 202, in train
    self.train_epoch(epoch)
  File "/media/SSD_1_2T/xt/MindBridge/src/trainer_fmri_img.py", line 853, in train_epoch
    self.train_step(voxel, image, subj_id, epoch)
  File "/media/SSD_1_2T/xt/MindBridge/src/trainer_fmri_img.py", line 241, in train_step
    fmri_image_fc, fmri_image_2, fmri_image_3, fmri_image_4, fmri_image_5, fmri_image_6, fmri_rec, loss_cyc = self.voxel2clip(
  File "/home/fmri/miniconda3/envs/xt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/fmri/miniconda3/envs/xt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/media/SSD_1_2T/xt/MindBridge/src/models.py", line 477, in forward
    subj_list = x[1].tolist()  # (s,)
KeyboardInterrupt
>>> Epoch5 | Iter2 | voxel: torch.Size([800, 8192])
>>> Epoch5 | Iter3 | voxel: torch.Size([800, 8192])
>>> Epoch5 | Iter4 | voxel: torch.Size([800, 8192])
>>> Epoch5 | Iter5 | voxel: torch.Size([800, 8192])